@using MidStateShuttleService.Enums
@model MidStateShuttleService.Models.RegisterModel

@{
    ViewBag.Title = "Shuttle Service Request";
}

<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
<link rel="stylesheet" href="/css/Form.css" />
<link rel="stylesheet" href="/css/Input.css" />
<link rel="stylesheet" href="/css/HelpIcon.css" />

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

<body>
    <div class="form-container">
        <div class="form-paper">

            <!-- Intro Note -->
            <section class="form-section intro-section">
                <p>
                    This form is for requesting shuttle service. Fill it out for each day you need a ride, so we can plan the best routes for students.
                </p>
            </section>

            <!-- Special Request -->
            <section class="form-section special-request">
                <h5>Need to Schedule a Special Ride?</h5>
                <p>Please submit a <strong>Special Request</strong> if:</p>
                <ul>
                    <li>Your ride is during the <strong>summer term</strong></li>
                    <li>Your ride is on a <strong>Friday</strong></li>
                    <li>You only need to ride once</li>
                </ul>
                <a class="btn-midstate btn-primary"
                   asp-area=""
                   asp-controller="Register"
                   asp-action="SpecialRequest">
                    Submit a Special Request
                </a>
            </section>

            <!-- Main Form -->
            <section class="form-section main-form">
                <h2>Request a Ride</h2>

                @using (Html.BeginForm("Register", "Register", FormMethod.Post, new { id = "registrationForm" }))
                {
                    @Html.AntiForgeryToken()

                    <!-- TERM -->
                    <div class="form-group">
                        @Html.DropDownListFor(x => x.Term,
                            (IEnumerable<SelectListItem>)ViewBag.Terms,
                            "Select Term",
                            new { @class = "dropdown-midstate", required = "required" })
                    </div>

                    <!-- ADD DAY BUTTON -->
                    <div class="form-group">
                        <button type="button" class="btn-midstate btn-primary" id="addDayBtn">
                            Add Day +
                        </button>
                    </div>

                    <!-- DAY CARDS CONTAINER -->
                    <div id="dayCardsContainer"></div>

                    <!-- TERMS -->
                    <div class="form-group terms-group">
                        <div class="checkbox-midstate">
                            <input asp-for="AgreeTerms" type="checkbox" id="AgreeTerms" name="AgreeTerms" value="true" />
                            <label for="AgreeTerms">
                                I understand my transportation request will be reviewed but is not guaranteed.
                                I will be required to communicate and confirm my request with the shuttle program before it is scheduled.
                            </label>
                        </div>
                    </div>

                    <!-- SUBMIT -->
                    <div class="form-group submit-group">
                        <button class="btn-midstate btn-primary" type="submit">Submit</button>
                        <button class="btn-midstate btn-secondary" type="button" onclick="location.href='/Register/Register'">Cancel</button>
                    </div>
                }
            </section>
        </div>
    </div>

    <!-- Day Card Template -->
    <template id="dayCardTemplate">
        <div class="day-card form-paper mb-4 p-4" data-day-index="__dayIndex__">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h4 class="mb-0">Day Request</h4>
                <button type="button"
                        class="btn-midstate btn-danger removeDayBtn">
                    Remove
                </button>
            </div>

            <!-- DAY DROPDOWN -->
            <div class="form-group mb-3">
                <select class="dropdown-midstate day-select"
                        name="DaySchedules[__dayIndex__].WeekDay"
                        required>
                    <option value="">Select Day</option>
                    <option>Monday</option>
                    <option>Tuesday</option>
                    <option>Wednesday</option>
                    <option>Thursday</option>
                </select>
            </div>

            <!-- ADD RIDE BUTTON -->
            <div class="form-group mb-3">
                <button type="button"
                        class="btn-midstate btn-secondary addRideBtn">
                    Add Ride +
                </button>
            </div>

            <!-- RIDES CONTAINER -->
            <div class="ridesContainer mt-2"></div>
        </div>
    </template>

    <!-- Location Pair Template -->
    <template id="rideTemplate">
        <div class="ride-row row mb-2 align-items-center" data-ride-index="__rideIndex__">

            <div class="col-3">
                <select class="dropdown-midstate"
                        name="DaySchedules[__dayIndex__].Rides[__rideIndex__].PickUpLocationID">
                    <option value="">Pick-Up</option>
                    @foreach (var loc in Model.LocationNames)
                    {
                        <option value="@loc.Value">@loc.Text</option>
                    }
                </select>
            </div>

            <div class="col-3">
                <select class="dropdown-midstate"
                        name="DaySchedules[__dayIndex__].Rides[__rideIndex__].DropOffLocationID">
                    <option value="">Drop-Off</option>
                    @foreach (var loc in Model.LocationNames)
                    {
                        <option value="@loc.Value">@loc.Text</option>
                    }
                </select>
            </div>

            <div class="col-3">
                <select class="dropdown-midstate"
                        name="DaySchedules[__dayIndex__].Rides[__rideIndex__].DropOffTime" required>
                    <option value="">Time</option>
                </select>
            </div>

            <div class="col-3">
                <button type="button"
                        class="btn-midstate btn-danger removeRideBtn w-100">
                    Remove
                </button>
            </div>

        </div>
    </template>

<script src="/js/Registeration/RegisterValidation.js"></script>
<script src="/js/Registeration/RouteUpdater.js"></script>
<script src="/js/Registeration/ReturnRouteUpdater.js"></script>
<script src="/js/Registeration/routeVisibility.js"></script>
<script src="/js/helpicon.js"></script>
<script src="/js/DayCards.js"></script>

</body>

